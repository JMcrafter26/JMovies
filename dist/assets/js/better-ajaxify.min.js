/**
 * better-ajaxify: Ajax website engine for better-dom
 * @version 2.0.0 Sun, 18 Jun 2017 07:42:31 GMT
 * @link https://github.com/chemerisuk/better-ajaxify
 * @copyright 2017 Maksim Chemerisuk
 * @license MIT
 */
!function(e,t,a){"use strict";function n(t,a){e.addEventListener(t,function(e){e.defaultPrevented||a(e)},!1)}function r(t,a){e.addEventListener(t,a,!0)}function i(t,a,n){var r=e.createEvent("CustomEvent");return r.initCustomEvent("ajaxify:"+a,!0,!0,n||null),t.dispatchEvent(r)}function o(t,a){var n=e.body;i(n,"update",a)&&n.parentNode.replaceChild(t.body,n),l.indexOf(c)<0&&l.push(c),e.title=t.title}function u(t){var a=d.exec(t),n=e.implementation.createHTMLDocument(a&&a[1]||"");return n.body.innerHTML=t.trim().replace(a&&a[0],""),n}if("function"==typeof a.pushState){var s,f=function(e){return e},d=/<title>(.*?)<\/title>/,l=[],c={};n("click",function(a){for(var n=e.body,r=a.target;r&&r!==n;r=r.parentNode)if("a"===r.nodeName.toLowerCase()){if(!r.target){var o=r.href;if("true"===r.getAttribute("aria-disabled"))a.preventDefault();else if(o&&0===o.indexOf("http")){var u=t.href;o===u||o.split("#")[0]!==u.split("#")[0]?i(r,"fetch")&&a.preventDefault():(t.hash=r.hash,a.preventDefault())}}break}}),n("submit",function(e){var t=e.target;if(!t.target)if("true"===t.getAttribute("aria-disabled"))e.preventDefault();else{var a,n=t.getAttribute("enctype");if("multipart/form-data"===n)a=new FormData(t);else{a={};for(var r,o=0;r=t.elements[o];++o){var u=r.type;if(u&&r.name&&!r.disabled){var d=r.name;if("select-multiple"===u)for(var l,c=0;l=r.options[c];++c)l.selected&&(a[d]=a[d]||[]).push(l.value);else("checkbox"!==u&&"radio"!==u||r.checked)&&(a[d]=r.value)}}}if(i(t,"serialize",a)){if(a instanceof FormData)s=a;else{var p="text/plain"===n?f:encodeURIComponent,v=p===f?/ /g:/%20/g;s=Object.keys(a).map(function(e){var t=p(e),n=a[e];return Array.isArray(n)&&(n=n.map(p).join("&"+t+"=")),t+"="+p(n)}).join("&").replace(v,"+")}i(t,"fetch")&&e.preventDefault(),s=null}else e.preventDefault()}}),n("ajaxify:fetch",function(e){var t=e.target,a=new XMLHttpRequest,n=(t.method||"GET").toUpperCase(),r=t.nodeName.toLowerCase(),o=t.nodeType,u=e.detail;"a"===r?u=u||t.href:"form"===r&&(u=u||t.action,"GET"===n&&s&&(u+=(~u.indexOf("?")?"&":"?")+s,s=null)),["abort","error","load","timeout"].forEach(function(e){a["on"+e]=function(){1===o&&t.removeAttribute("aria-disabled"),i(t,e,a)}}),a.open(n,u,!0),i(t,"send",a)&&(a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"!==n&&a.setRequestHeader("Content-Type",t.getAttribute("enctype")||t.enctype),a.send(s),1===o&&t.setAttribute("aria-disabled","true"))}),r("ajaxify:load",function(e){var a=e.detail,n=a.response,r=a.responseURL;!r&&n&&n.URL&&(r=a.getResponseHeader("Location"),r&&(r=t.origin+r,Object.defineProperty(a,"responseURL",{get:function(){return r}})))}),n("ajaxify:load",function(e){var n=e.detail,r=u(n.responseText),i={body:r.body};r.title?i.title=r.title:i.title=n.status+" "+n.statusText,o(i,r),c={};var s=n.responseURL;s!==t.href&&a.pushState(l.length,i.title,s)}),r("ajaxify:update",function(t){var a=t.detail;"string"==typeof a&&(a=u(a),Object.defineProperty(t,"detail",{get:function(){return a}})),c.body=t.target,c.title=e.title}),window.addEventListener("popstate",function(e){if(!e.defaultPrevented&&e.state>=0){var t=l[e.state];t&&(o(t,t.body),c=t)}}),a.replaceState(0,e.title)}}(window.document,window.location,window.history);